# Security hardening for uploads directory
Options -Indexes

# Block execution of scripts in uploads
<FilesMatch "\.(php|phar|phtml|pl|py|rb|cgi|sh|bat|ps1)$">
    Require all denied
</FilesMatch>

# Prevent access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>
# Deny PHP execution inside uploads
<FilesMatch "\.(php|php\d*|phtml)$">
  Require all denied
</FilesMatch>
# Allow images only
<FilesMatch "\.(jpe?g|png|webp|gif)$">
  Require all granted
</FilesMatch>
AddType image/jpeg .jpg .jpeg
AddType image/png .png
AddType image/webp .webp
AddType image/gif .gif
